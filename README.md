# Prueba
Pruebo
Script
Rem 315 - Aporte Obra Social COMERCIO Sub Main() stop If liquidacion.tipoliquidacion.codigo<>"04-SAC" AND (LIQUIDACION.MES<>12 OR LIQUIDACION.MES<>6 ) Then Else empleado.boextension.basemoprededucciones=0 empleado.boextension.basemoprecontribuciones=0 End If If not empleado.CONDICIONEMPLEADO is nothing then If empleado.CONDICIONEMPLEADO.codigo = "2" then exit sub '' SI LA CONDICION EN SIJP ES 2 NO SE CALCULA ESTE CONCEPTO End if If novedad.value then detalleliquidacion.cantidad_cantidad= detalleliquidacion.cantidad_cantidad detalleliquidacion.Valor_Importe= detalleliquidacion.valor_Importe else xbase = 0 band = 0 'If empleado.situacion.codigo <> "13" Then xbase = xbase + buscarconcepto("299", "I",resumenliquidacion) xbase = xbase + buscarconcepto("133", "I",resumenliquidacion) If liquidacion.tipoliquidacion.codigo<>"05-VAC" and liquidacion.tipoliquidacion.codigo<>"04-SAC" then xbase = xbase + BuscarConceptoHistorico3("299", "I", Empleado, "05-VAC;04-SAC", "A", liquidacion.inicioperiodo, liquidacion.finperiodo, "SUM") xbase = xbase + BuscarConceptoHistorico3("133", "I", Empleado, "05-VAC;04-SAC", "A", liquidacion.inicioperiodo, liquidacion.finperiodo, "SUM") End If End if If empleado.boextension.porcentajejornada>0 then band=1 if xbase>0.01 then xbase = round(100 * xbase / empleado.boextension.porcentajejornada, 2) End if If "1.1" = cDbl("1.1") Then xTope = cDbl(Replace(Parametro(Empresa,"TOPE"), ",", ".")) Else xTope = cDbl(Replace(Parametro(Empresa,"TOPE"), ".", ",")) End If If Liquidacion.TipoLiquidacion.Codigo = "04-SAC" Then xTope = xTope / 2 End If If xBase > xTope Then xBase = xTope End If If "1.1" = CDBL("1.1") Then xMopre = Replace(Parametro(Empresa,"MOPRE"), ",", ".") xMopreC = Replace(Parametro(Empresa,"MOPRECANTIDAD"),",", ".") Else xMopre = Replace(Parametro(Empresa,"MOPRE"), ".", ",") xMopreC = Replace(Parametro(Empresa,"MOPRECANTIDAD"),".", ",") End If empleado.boextension.basemoprededucciones=0 LicMaternidad = cdbl(buscarconcepto("160", "I", RESUMENLIQUIDACION)) if licMaternidad <> 0.01 and empleado.fechaingreso<liquidacion.inicioperiodo and liquidacion.tipoliquidacion.codigo="01-MES" and empleado.situacion.codigo<>"5" then ' solo los que estuvieron activos todo el mes if (month(empleado.fechabaja)<>liquidacion.mes or year(empleado.fechabaja)="1899" ) then If Liquidacion.mes = 12 Or Liquidacion.mes = 6 Then xMopre = xMopre * (xMopreC + (xMopreC/2))' xMopre = xMopre*3 Else xMopre = xMopre * xMopreC End If IF EMPLEADO.SITUACION.CODIGO = "14" THEN ELSE If xbase > (xMopre) Or xbase = 0.01 then else xbase= xbase+BuscarConcepto( "2007", "I", Resumenliquidacion ) If xbase>(xMopre) then xbase=xbase-BuscarConcepto( "2007", "I", Resumenliquidacion ) else empleado.boextension.basemoprededucciones=xbase' empleado.boextension.basemoprededucciones '+ xbase end if end if END IF end if end if IF "1.1"=CDBL("1.1") THEN xParametro=Replace(Parametro(Empresa,"OBRA"), ",", ".") ELSE xParametro=Replace(Parametro(Empresa,"OBRA"), ".", ",") END IF xParametro = cDbl(xParametro)/100 xImp=ROUND(XBASE*XPARAMETRO,2) if liquidacion.tipoliquidacion.codigo<>"05-VAC" and liquidacion.tipoliquidacion.codigo<>"04-SAC" then ximp = ximp - BuscarConceptoHistorico3("315", "I", Empleado, "05-VAC", "A", liquidacion.inicioperiodo, liquidacion.finperiodo, "SUM") - _ BuscarConceptoHistorico3("315", "I", Empleado, "04-SAC", "A", liquidacion.inicioperiodo, liquidacion.finperiodo, "SUM") end if detalleliquidacion.cantidad_cantidad = XPARAMETRO detalleliquidacion.Valor_Importe = xImp if empleado.boextension.porcentajejornada > 0 then xadicional = xImp - (xImp*empleado.boextension.porcentajejornada/100) empleado.Iadicionalos = xadicional else empleado.Iadicionalos = 0 end if end if 'end if End sub
